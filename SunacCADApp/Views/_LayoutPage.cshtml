<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>@ViewBag.Title</title>
    <link href="~/Content/Css/bootstrap.min.css" rel="stylesheet" />
    <link href="~/Content/Css/sunac.css" rel="stylesheet" />
    <script src="~/Content/Js/jquery-1.12.4.min.js" type="text/javascript"></script>
    <script src="~/Content/Js/jquery.form.js" type="text/javascript"></script>
    <script src="~/Content/Js/goyeer.validation.js" type="text/javascript"></script>
    <script src="~/Content/Plugins/layer/layer.js" type="text/javascript"></script>
    <script src="~/Content/Plugins/laydate/laydate.js" type="text/javascript"></script>
    <script src="~/Content/Plugins/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
   <script type="text/javascript">
       $(function () {
           $(".upfile").on("click", "del", function () {
               let that = $(this);
               let parent = $(this).parent();
               that.parent().empty();
               let content = '<input type="file"  />';
               parent.append(content);
           })

           $(".upfile").on("click", "img", function () {
               let src = $(this).attr("src");
               layer.open({
                   type: 1,
                   title: false,
                   closeBtn: 0,
                   area: '400',
                   skin: 'layui-layer-nobg', //没有背景色
                   shadeClose: true,
                   content: "<img  src='"+src+"' width='400'>"
               });
           })


           $(".upfile").on("change", "input[type='file']", function () {
               let IMG_ROUTE = $(this).val();
               let that = $(this);
               if (_isNull(IMG_ROUTE))
               {
                   layer.msg("上传文件不能为空", { icon: 5 });
                   return;
               }
               IMG_ROUTE = IMG_ROUTE.toLowerCase();
               var IMG_ENDFOUR = IMG_ROUTE.substr(IMG_ROUTE.length - 4, 4);
               if (IMG_ENDFOUR != ".dwg") {
                   layer.msg("上传文件格式不正确", { icon: 5 });
                   return;
               }
               var formData = new FormData();
               formData.append("file", that[0].files[0]);
               $.ajax({
                   url: '/CommonLib/UpFile', /*接口域名地址*/
                   type: 'post',
                   data: formData,
                   contentType: false,
                   processData: false,
                   dataType:'json',
                   success: function (res) {
                       if (res.Code == 100) {
                           let img = ' <img src="' + res.ImgPath + '" /><del></del>';
                           img += '<input type="hidden" name="cad_file" value="' + res.CadPath + '"/>';
                           img += '<input type="hidden" name="img_file" value="' + res.ImgPath + '"/>';
                           $("figure img").attr("src",res.ImgPath);
                           that.parent().append(img);
                           that.remove();
                       } else {
                           layer.alert(res.Message, {icon:5})
                       }
                   }
               })
           });
            
           $(".select-all").on("change", function () {
               let that = $(this).parent().parent();
               that.find(".single-checkbox").prop("checked", $(this).prop("checked"));
           })
       });
  </script>
</head>
<body>
    <div class="container-fluid">
        <header>

        </header>
        <div class="main">
            <div class="leftsidebar">
                <dl>
                    <dt class="icon-standardpart">
                        <a class="down">标准部品库</a>     
                    </dt>
                    <dd>
                        <a href="/window/index">外窗</a>
                        <a href="/door">门</a>
                        <a href="/handrail/index">栏杆</a>
                    </dd>
                </dl>
                <dl>
                    <dt class="icon-space">
                        <a class="down">标准空间模块库</a>    
                    </dt>
                    <dd>
                        <a href="/Kitchen/Index">厨房</a>
                        <a href="/bathroom/index">卫生间</a>
                        <a href="/airconditioner">空调</a>

                    </dd>
                </dl>
                <dl>
                    <dt class="one icon-project">
                        <a href="#" class="right">项目管理</a>
                    </dt>
                </dl>
                <dl>
                    <dt class="icon-background">
                        <a href="#" class="down">后台管理</a>
                    </dt>
                    <dd>
                        <a href="/home/usercenter">用户管理</a>
                        <a href="/home/usercenter">角色管理</a>
                        <a href="/home/usercenter">配置管理</a>
                        <a href="/home/usercenter">机构管理</a>
                        <a href="/home/usercenter">日志管理</a>
                    </dd>

                </dl>
            </div>
            <div class="center">
                @RenderBody()
            </div>
                
        </div>
           
    </div>

</body>
</html>
